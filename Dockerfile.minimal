# Минимальный Dockerfile без системных зависимостей
FROM node:18-slim

# Рабочая директория
WORKDIR /app

# Копирование package files и установка зависимостей
COPY package*.json ./
RUN npm ci && npm cache clean --force

# Копирование исходного кода
COPY . .

# Сборка приложения
RUN npm run build

# Создание директории для логов
RUN mkdir -p /app/logs

# Порт
EXPOSE 3000

# Запуск приложения напрямую
CMD ["node", "dist/index.js"]